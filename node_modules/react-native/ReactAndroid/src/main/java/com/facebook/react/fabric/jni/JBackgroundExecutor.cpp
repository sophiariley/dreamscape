/*
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

<<<<<<< HEAD
<<<<<<< HEAD
#include "JBackgroundExecutor.h"

#include <fbjni/NativeRunnable.h>
#include <fbjni/fbjni.h>
=======
=======
>>>>>>> origin
#include <fbjni/fbjni.h>
#include <react/jni/JNativeRunnable.h>

#include "JBackgroundExecutor.h"
<<<<<<< HEAD
>>>>>>> origin/Sophia's-branch
=======
>>>>>>> origin

namespace facebook {
namespace react {

using namespace facebook::jni;

<<<<<<< HEAD
<<<<<<< HEAD
BackgroundExecutor JBackgroundExecutor::create(const std::string &name) {
  auto instance = make_global(newInstance(name));
  return [instance = std::move(instance)](std::function<void()> &&runnable) {
    static auto method =
        javaClassStatic()->getMethod<void(JRunnable::javaobject)>(
            "queueRunnable");
    auto jrunnable = JNativeRunnable::newObjectCxxArgs(std::move(runnable));
    method(instance, jrunnable.get());
=======
=======
>>>>>>> origin
using facebook::react::JNativeRunnable;
using facebook::react::Runnable;

BackgroundExecutor JBackgroundExecutor::get() {
  auto self = JBackgroundExecutor::create();

  return [self](std::function<void()> &&runnable) {
    static auto method =
        findClassStatic(JBackgroundExecutor::JBackgroundExecutorJavaDescriptor)
            ->getMethod<void(Runnable::javaobject)>("queueRunnable");

    auto jrunnable = JNativeRunnable::newObjectCxxArgs(std::move(runnable));
    method(self, static_ref_cast<Runnable::javaobject>(jrunnable).get());
<<<<<<< HEAD
>>>>>>> origin/Sophia's-branch
=======
>>>>>>> origin
  };
}

} // namespace react
} // namespace facebook
